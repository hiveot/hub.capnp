# Launcher

The WoST Launcher manages starting and stopping WoST services based on the configuration.
Use of the launcher is optional but simplifies running WoST services with dapr.

## Summary

The launcher starts WoST services with their dapr sidecar and configured bindings.
It is configured through the launcher.yaml configuration file. See templates/launcher.yaml for examples.

## Build & Install

Use 'make build' to build the launcher CLI.

Use 'make install' to install the launcher locally in the current user's 'bin' folder.

## Launcher Configuration

The launcher is configured through the 'launcher.yaml' file. This file describes the services to launch and how to run them using dapr.

Format:

```yaml

# core services are launched first 
services:
  certs          # IoT certificate management
  thingstore     # Thing directory store
  historystore   # Thing history store
  thingpubsub    # internal pubsub for storing thing info
  provisioning   # provisioning of IoT devices

# api gateway services, launcher after the core services
gateway:
  mqttgw         # mqtt message bus gateway for consumers and devices
  thinggw        # thing api gateway for directory/history/provisioning
  dashboard      # WoST dashboard for viewing IoT device info

# IOT bindings are dapr input and output bindings that push data onto internal message bus
bindings:
  owserver-pb    # Publish Things connected to a local OWServer V2 1-wire gateway
  ipcam          # Publish IP camera images
  openzwave      # Publish Devices connected to a local openzwave controller
  lorawan        # Publish devices connected to a LoraWan gateway
  snmp           # Publish local network devices discovered using SNMP
  canweather     # Publish weather forecast from service canada weather API
  darksky        # Publish weather forecast from dark-sky
```

Each service or gateway entry can have additional specifications:

```yaml
services:
  # name of the service binary
  serviceName:
    # optional flag, the service is enabled. Set to false to disable launching the service.
    enabled: true

    # Optional application binary in the bin folder. Default is bin/serviceName
    #app-bin: serviceName

    # Optional app-id to use with dapr. Default is the serviceName.
    #app-id: serviceName

    # Optional grpc or http port the service listens on. Default is to use an app-socket. 
    #app-port: 11000

    # Optional protocol the service uses: grpc or http. Default is http.
    #app-protocol: http

    # Optional unix domain socket the service listens on. Default is the unix domain socket using the serviceName. 
    #app-socket: /tmp/wost/serviceName

    # Optional dapr http port override. Default is generated by dapr.
    #dapr-http-port: 993
    # Optional dapr grpc port override. Default is generated by dapr.
    #dapr-grpc-port: 12000


    # Optional loglevel to use. debug, info, warn, error. Default is warn
    #loglevel: warn

    # Optional dapr sidecar template. Default is config.yaml in the template directory  
    #dapr-template: config.yaml
```

## Usage

See launcher --help 
